<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>퍼블 - 오더1</title>
    <link rel="stylesheet" href="css/style.css">

</head>
<body>
    <!-- 뒤로기 모달 -->
    <div class="normal-modal-bg">
        <div class="normal-modal">
            <p class="lg-bold">뒤로가기</p>
            <div class="normal-modal__txt">
                <p class="md-reg">작성중인 내용이 저장되지 않습니다.</p>
                <p class="md-reg">뒤로 가시겠습니까?</p>
            </div>
            <div class="normal-modal__btnsct align both">
                <button class="btn-insideout sm-reg">뒤로가기</button>
                <button class="btn-normal sm-reg">이어가기</button>
            </div>
        </div>
    </div>
    <!-- 페이지 헤더 -->
    <header class="page-header">
        <h1 class="xl-bold-title">예약 주문서 작성</h1>
        <div>
            <button class="btn-prev" aria-label="뒤로가기"></button>
        </div>
    </header>
    <!-- 메인 -->
    <main class="mg16_lr">
        <!-- 구매자 정보 -->
        <div class="buyer">
            <header class="buyer__header">
                <span class="md-bold-title">구매자 정보</span>
            </header>
            <div class="buyer__input">
                <label class="md-reg">이름</label>
                <input class="md-reg" type="text" maxlength="5" placeholder="구매자 이름" id="buyerName">
                <p class="sm-reg error-msg">입력해 주세요.</p>   <!-- 에러: 입력해 주세요. -->
            </div>
            <div class="buyer__input">
                <label class="md-reg">연락처</label>
                <input class="md-reg" type="text" maxlength="13" placeholder="구매자 연락처" id="buyerPhone">
                <p class="sm-reg error-msg"></p>   <!-- 에러: 입력해 주세요. / 11자리 숫자 입력. -->
                <!-- <input class="md-reg" type="number" inputmode="numeric" maxlength="13" placeholder="구매자 연락처 (11자리 숫자)" id="buyerPhone"> -->
            </div>
        </div>
        <!-- 입금 정보 -->
        <div class="deposit">
            <header class="deposit__header">
                <span class="md-bold-title">입금 정보</span>
                <div class="deposit__header__checkbox">
                    <button class="btn-check_off" id="sameAsBuyerCheckBox"></button>
                    <span>구매자와 동일</span>
                </div>
            </header>
            <p class="sm-reg inform-msg">** 구매자와 입금자의 이름이 다른 경우 입력해주세요. 보내는 사람이 다를경우 예약 확인이 어렵습니다.</p>
            <div class="deposit__input">
                <label class="md-reg">보내는 사람</label>
                <input class="md-reg" type="text" maxlength="5" placeholder="보내는 사람 이름" id="depositName">
                <p class="sm-reg error-msg">입력해 주세요.</p>   <!-- 에러: 입력해 주세요. -->
            </div>
        </div>
        <!-- 픽업 일시 -->
        <div class="pickup">
            <header class="pickup__header">
                <div class="pickup__header__left">
                    <span class="md-bold-title">픽업 일시</span>
                </div>
                <div class="pickup__header__right">
                    <span class="sm-reg error-msg">픽업 시간을 선택해 주세요.</span>
                </div>
            </header>
            <p class="sm-reg inform-msg">** 홀케이크 예약은 예약 접수일을 기준으로 이틀 뒤부터 최대 2주 뒤까지 가능합니다.</p>
            <!-- 선택된 픽업 시간 & 날짜 안내 -->
            <div class="pickup__selected-info">
                <!-- <p class="md-reg">24년 9월 24일 화요일 오전 11:00</p> -->
                <p class="md-reg" id="pickupTimeDisplay">픽업 날짜와 시간을 선택해 주세요.</p>
            </div>
            
            <!-- 캘린더 -->
            <div class="pickup__calender">
                <!-- 날짜 선택 -->
                <div class="pickup__calender__dates">
                    <!-- 요일 -->
                    <div class="pickup__calender__dates__days">
                        <div class="cal-day"><span class="md-bold holiday">일</span></div>
                        <div class="cal-day"><span class="md-bold">월</span></div>
                        <div class="cal-day"><span class="md-bold">화</span></div>
                        <div class="cal-day"><span class="md-bold">수</span></div>
                        <div class="cal-day"><span class="md-bold">목</span></div>
                        <div class="cal-day"><span class="md-bold">금</span></div>
                        <div class="cal-day"><span class="md-bold holiday">토</span></div>
                    </div>
                    <div class="pickup__calender__dates__date">
                        <!-- 1주차 -->
                        <div class="cal-date"><span class="md-reg"></span></div>
                        <div class="cal-date"><span class="md-reg"></span></div>
                        <div class="cal-date--today"><span class="md-reg">24</span></div>
                        <div class="cal-date"><span class="md-reg">25</span></div>
                        <div class="cal-date"><span class="md-reg cal-available">26</span></div>
                        <div class="cal-date--selected"><span class="md-reg cal-available">27</span></div>
                        <div class="cal-date"><span class="md-reg">28</span></div>
                        <!-- 2주차 -->
                        <div class="cal-date"><span class="md-reg">29</span></div>
                        <div class="cal-date"><span class="md-reg">30</span></div>
                        <div class="cal-date"><span class="md-reg">31</span></div>
                        <div class="cal-date"><span class="md-reg">1</span></div>
                        <div class="cal-date"><span class="md-reg cal-available">2</span></div>
                        <div class="cal-date"><span class="md-reg cal-available">3</span></div>
                        <div class="cal-date"><span class="md-reg">4</span></div>
                        <!-- 3주차 -->
                        <div class="cal-date"><span class="md-reg">5</span></div>
                        <div class="cal-date"><span class="md-reg">6</span></div>
                        <div class="cal-date"><span class="md-reg">7</span></div>
                        <div class="cal-date"><span class="md-reg">8</span></div>
                        <div class="cal-date"><span class="md-reg"></span></div>
                        <div class="cal-date"><span class="md-reg"></span></div>
                        <div class="cal-date"><span class="md-reg"></span></div>
                    </div>
                </div>
                <!-- 라인 -->
                <div class="pickup__calender__line cake_order_none"></div>
                <!-- 시간 선택 -->
                <div class="pickup__calender__times cake_order_none">
                    <p class="md-bold">오전</p>
                    <div class="pickup__calender__times__board">
                        <span onclick="selectPickupTime(this)" class="badge-time md-reg">10:00</span>
                        <span onclick="selectPickupTime(this)" class="badge-time--disabled md-reg">10:30</span>
                        <span onclick="selectPickupTime(this)" class="badge-time md-reg">11:00</span>
                        <span onclick="selectPickupTime(this)" class="badge-time md-reg">11:30</span>
                    </div>
                    <p class="md-bold">오후</p>
                    <div class="pickup__calender__times__board">
                        <span onclick="selectPickupTime(this)" class="badge-time md-reg">12:20</span>
                        <span onclick="selectPickupTime(this)" class="badge-time md-reg">12:40</span>
                        <span onclick="selectPickupTime(this)" class="badge-time md-reg">13:20</span>
                        <span onclick="selectPickupTime(this)" class="badge-time--selected md-reg">13:40</span>
                        <span onclick="selectPickupTime(this)" class="badge-time md-reg">14:00</span>
                        <span onclick="selectPickupTime(this)" class="badge-time md-reg">14:30</span>
                        <span onclick="selectPickupTime(this)" class="badge-time md-reg">15:00</span>
                        <span onclick="selectPickupTime(this)" class="badge-time md-reg">15:30</span>
                        <span onclick="selectPickupTime(this)" class="badge-time md-reg">16:00</span>
                    </div>
                </div>
            </div>

            
        </div>
        <!-- 케이크 옵션 -->
        <div class="option">
            <header class="option__header">
                <div class="option__header__left">
                    <span class="md-bold-title">포장 옵션</span>
                    <button class="btn-info" onclick="showPackageInfo()"></button>
                </div>
                <div class="option__header__right">
                    <span class="sm-reg error-msg">옵션을 선택해 주세요.</span>
                </div>
                <div class="option__header__info" id="packageInfo">
                    <p class="sm-reg option__header__info__title">선물박스 크기</p>
                    <p class="sm-reg">소 : 휘낭시에 6개</p>
                    <p class="sm-reg">중 : 휘낭시에 10개</p>
                    <p class="sm-reg">대 : 휘낭시에 15 ~ 20개</p>
                </div>
            </header>
            <div class="option__cnt">
                <!-- 사이즈 -->
                <div class="option__cnt__opt">
                    <div class="option__cnt__opt__label">
                        <p class="md-reg error-label">사이즈</p>
                    </div>
                    <div class="option__cnt__opt__select">
                        <div class="option__cnt__opt__select__single">
                            <div class="option__cnt__opt__select__single__clickable">
                                <button class="btn-radio_off"></button>
                                <p class="md-reg">1호 (55,000원)</p>
                            </div>
                        </div>
                        <div class="option__cnt__opt__select__single">
                            <div class="option__cnt__opt__select__single__clickable">
                                <button class="btn-radio_on"></button>
                                <p class="md-reg">2호 (75,000원)</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="option__cnt__line"></div>

                <!-- 크림 변경 -->
                <div class="option__cnt__opt">
                    <div class="option__cnt__opt__label">
                        <p class="md-reg">크림 변경</p>
                    </div>
                    <div class="option__cnt__opt__select">
                        <div class="option__cnt__opt__select__single">
                            <div class="option__cnt__opt__select__single__clickable">
                                <button class="btn-radio_off"></button>
                                <p class="md-reg">안함</p>
                            </div>
                        </div>
                        <div class="option__cnt__opt__select__single">
                            <div class="option__cnt__opt__select__single__clickable">
                                <div class="option__cnt__opt__select__single__clickable">
                                    <button class="btn-radio_on"></button>
                                    <p class="md-reg">기본 (우유 생크림)</p>
                                </div>
                            </div>
                        </div>
                        <div class="option__cnt__opt__select__single">
                            <div class="option__cnt__opt__select__single__clickable">
                                <div class="option__cnt__opt__select__single__clickable">
                                    <button class="btn-radio_on"></button>
                                    <p class="md-reg">요거트 생크림 (+5,000원)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="option__cnt__line"></div>

                <!-- 초코 글라사쥬 -->
                <div class="option__cnt__opt">
                    <div class="option__cnt__opt__label">
                        <p class="md-reg">초코 글라사쥬</p>
                    </div>
                    <div class="option__cnt__opt__select">
                        <div class="option__cnt__opt__select__single">
                            <div class="option__cnt__opt__select__single__clickable">
                                <button class="btn-radio_off"></button>
                                <p class="md-reg">안함</p>
                            </div>
                        </div>
                        <div class="option__cnt__opt__select__single">
                            <div class="option__cnt__opt__select__single__clickable">
                                <div class="option__cnt__opt__select__single__clickable">
                                    <button class="btn-radio_on"></button>
                                    <p class="md-reg">초코 글라사쥬 데코 (+5,000)</p>
                                </div>
                            </div>
                        </div>
                        <div class="option__cnt__opt__select__single">
                            <div class="option__cnt__opt__select__single__clickable">
                                <div class="option__cnt__opt__select__single__clickable">
                                    <button class="btn-radio_on"></button>
                                    <p class="md-reg">하프 초코 (+5,000)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="option__cnt__line"></div>
                


            </div>
        </div>
        <!-- 환불 계좌 -->
        <div class="refund">
            <header class="refund__header">
                <div class="refund__header__left">
                    <span class="md-bold-title">환불 계좌</span>
                    <button class="btn-info" onclick="showRefundInfo()"></button>
                </div>
                <div class="refund__header__right">
                    <span class="sm-reg error-msg">은행을 선택해 주세요.</span>
                </div>
                <div class="refund__header__info" id="refundInfo">
                    <p class="sm-reg refund__header__info__title">환불이 가능한 경우</p>
                    <p class="sm-reg">* 예약이 접수 이후 관리자가 예약을 취소한 경우</p>
                    <p class="sm-reg">* 예약 확정 후 상호 합의된 이유에 의해 예약이 취소되는 경우</p>
                    <p class="sm-reg refund__header__info__imp">** 예약 확정 이후 단순변심 혹은 노쇼로 인한 예약 취소시 환불은 진행되지 않습니다.</p>
                </div>
            </header>
            <div class="refund__cnt">
                <div class="refund__cnt__top">
                    <div class="refund__cnt__top__bank">
                        <div class="refund__cnt__top__bank__dropdown" id="bankToggle">
                            <span class="md-reg">은행</span>
                            <div class="btn-dropdown"></div>
                        </div>
                        <ul class="refund__cnt__top__bank__dropdown-options" id="bankSelect">
                            <li class="refund__cnt__top__bank__dropdown-options__li"><span class="md-reg">국민은행</span></li>
                            <li class="refund__cnt__top__bank__dropdown-options__li"><span class="md-reg">우리은행</span></li>
                            <li class="refund__cnt__top__bank__dropdown-options__li"><span class="md-reg">하나은행</span></li>
                            <li class="refund__cnt__top__bank__dropdown-options__li"><span class="md-reg">국민은행</span></li>
                            <li class="refund__cnt__top__bank__dropdown-options__li"><span class="md-reg">우리은행</span></li>
                            <li class="refund__cnt__top__bank__dropdown-options__li"><span class="md-reg">하나은행</span></li>
                            <li class="refund__cnt__top__bank__dropdown-options__li"><span class="md-reg">국민은행</span></li>
                            <li class="refund__cnt__top__bank__dropdown-options__li"><span class="md-reg">우리은행</span></li>
                            <li class="refund__cnt__top__bank__dropdown-options__li"><span class="md-reg">하나은행</span></li>
                        </ul>
                    </div>
                    <input class="md-reg" type="text" maxlength="5" placeholder="예금주">
                    <p class="sm-reg error-msg">입력해 주세요.</p>
                </div>
                <div class="refund__cnt__bottom">
                    <input class="md-reg" type="text" placeholder="계좌 번호">
                    <p class="sm-reg error-msg">입력해 주세요.</p>
                </div>
            </div>
        </div>
        <!-- 추가 요청사항 -->
        <div class="request">
            <header class="request__header">
                <span class="md-bold-title">추가 요청사항</span>
                <span class="sm-reg error-msg" id="requestErrorMsg">공백 포함 최대 150자까지 입력 가능합니다.</span>
            </header>
            <div class="request__txtarea">
                <textarea class="sm-reg" maxlength="150" rows="5" cols="30" placeholder="요청사항이 있다면 입력해주세요.(공백포함 최대 500자)" id="requestTxtarea"></textarea>
                <span class="sm-reg request__txtarea__count" id="requestCount">0/150</span>
            </div>
        </div>

        <!-- 구움과자: 포장 옵션 -->
        <!-- <div class="refund">
            <header class="refund__header">
                <span class="md-bold-title">포장 옵션</span>
                <button class="btn-info" onclick="showPackageInfo()"></button>
                <div class="refund__header__info" id="packageInfo">
                    <p class="sm-reg refund__header__info__title">선물박스 크기</p>
                    <p class="sm-reg">소 : 휘낭시에 6개</p>
                    <p class="sm-reg">중 : 휘낭시에 10개</p>
                    <p class="sm-reg">대 : 휘낭시에 15 ~ 20개</p>
                </div>
            </header>
        </div> -->

        <!-- 예약하기 버튼: fixed -->
        <div class="proceed-order">
            <button class="btn-normal">55,000원에 예약하기</button>
        </div>
    </main>
    
    <!-- <main class=".mg16_lr">        
        <div class="proceed-order">
            <button class="btn-normal">55,000원에 예약하기</button>
        </div>
    </main> -->
    <!-- 스크립트 -->
    <script>
        const bankToggle = document.getElementById("bankToggle");
        const bankSelect = document.getElementById("bankSelect");
        const bankOptions = document.querySelectorAll(".refund__cnt__top__bank__dropdown-options__li");

        // 오늘 날짜 구하기 (24년 10월 2일 수요일 오후 4:00)
        const today = new Date();
        const str_year = today.getFullYear().toString().slice(-2);
        const str_month = (today.getMonth() + 1).toString();
        const str_date = today.getDate().toString();
        const str_day = getDay(today.getDay());
        const todayFull = `${str_year}년 ${str_month}월 ${str_date}일 ${str_day} `

        // 공통 함수 --------------------------------------------------------------------------------------
        function getDay(num) {
            if (num === 0) {return "일요일"}
            else if (num === 1) {return "월요일 "}
            else if (num === 2) {return "화요일 "}
            else if (num === 3) {return "수요일 "}
            else if (num === 4) {return "목요일 "}
            else if (num === 5) {return "금요일 "}
            else if (num === 6) {return "토요일 "}
        }


        // 은행 드롭다운 열기 / 닫기
        bankToggle.addEventListener("click", () => {
            bankSelect.style.display = bankSelect.style.display === "block" ? "none" : "block";
        });

        // 은행 클릭시 select에 텍스트 채워지기
        bankOptions.forEach(opt => {
            opt.addEventListener("click", () => {
                bankToggle.querySelector("span").textContent = opt.textContent;
                bankSelect.style.display = "none";
            })
        });
        
        // 환불계좌 인포 보여주기
        function showRefundInfo() {
            const refundInfo = document.getElementById("refundInfo");
            refundInfo.classList.toggle("show-info");
        }

        // 구움과자: 선물포장 인포 보여주기
        function showPackageInfo() {
            const refundInfo = document.getElementById("packageInfo");
            refundInfo.classList.toggle("show-info");
        }

        // 픽업시간 ----------------------------------------------------------------------------------------------------
        function selectPickupTime(span) {
            // --selected 되어있는 다른 클래스명 지우기
            let alreadySelected = document.querySelector(".badge-time--selected");
            if (alreadySelected) {alreadySelected.classList.replace("badge-time--selected", "badge-time")}

            // str 시간 구하기
            const pickupTime = span.innerText;   // '10:00'
            let ampm = "";
            if (pickupTime < "12:00") {ampm = "오전"} else {ampm = "오후"}
            const str_pickupTime = `${ampm} ${pickupTime}`;   // '오전 10:00'

            // 뱃지 클래스명 바꾸기
            span.classList.replace("badge-time", "badge-time--selected");
            // 픽업시간 박아넣기
            pickupTimeDisplay.innerText = `${todayFull + str_pickupTime}`;
        }

        // ++++++++++++++++++++++++ 인풋 필드 검증 변수 ----------------------------------------------------------------------
            // 이름 - 특수문자 정규식 (숫자, 공백포함) / 완성형 아닌 한글 정규식
        const nameSpecialChar = /[~!@\#$%^&*\()\-=+_'\;<>0-9\/.\`:\"\\,\[\]?|{} ]/gi;
        const notFullKorean = /[ㄱ-ㅎㅏ-ㅣ]/gi;
            // 휴대폰 번호 - 숫자만 가능
        const phonenumNotInt = /[^0-9]/gi;
        // 공통요소 ----------------------------------------------------------------------
        const buyerName = document.getElementById("buyerName");
        const buyerPhone = document.getElementById("buyerPhone");
        const sameAsBuyerCheckBox = document.getElementById("sameAsBuyerCheckBox");
        const depositName = document.getElementById("depositName");
        const requestTxtarea = document.getElementById("requestTxtarea");
        const requestCount = document.getElementById("requestCount");
        const requestErrorMsg = document.getElementById("requestErrorMsg");


        // required 함수 
        function showBuyerNameError() {
            // label: error-label 클래스 추가
            buyerName.previousElementSibling.className += " error-label";
            // input: error-input 클래스 추가 + placeholder 없애기
            buyerName.className += " error-input";
            // p: display block + innerText "11자리 숫자 입력."
            buyerName.nextElementSibling.style.display = "block";
        }

        document.addEventListener("DOMContentLoaded", function() {
            // 구매자 정보 ------------------------------------------------------------------------------------------------------------------
            // 이름 ------------------
            buyerName.addEventListener("focusin", function() {   // focusin: 오류메세지 원복
                // label: 클래스명 원복
                buyerName.previousElementSibling.className = "md-reg";
                // input: 클래스명 원복
                buyerName.className = "md-reg";
                // p: display none
                buyerName.nextElementSibling.style.display = "none";
            })

            buyerName.addEventListener("keyup", function() {   // keyup: 공백, 숫자, 특수문자 불가
                buyerName.value = buyerName.value.replace(nameSpecialChar, "");
            });
            buyerName.addEventListener("focusout", function() {   // focusout: 미완성한글 불가
                let x = buyerName.value;
                if (x.length > 0) {
                    if (x.match(nameSpecialChar) || x.match(notFullKorean)) {
                        x = x.replace(nameSpecialChar, "").replace(notFullKorean, "");
                    }
                    buyerName.value = x;
                }
            });
            // 연락처 -----------------
            buyerPhone.addEventListener("keyup", function() {   // keyup: 숫자만 허용
                buyerPhone.value = buyerPhone.value.replace(phonenumNotInt, "");
            })
            buyerPhone.addEventListener("focusout", function() {   // focusout
                let x = buyerPhone.value;
                if (x.length === 11) {   // 유저 인풋이 11자리이면 대쉬 넣어주기
                    buyerPhone.value = `${x.slice(0, 3)}-${x.slice(3, 7)}-${x.slice(7)}`;
                } else if (x.length === 13 && x.indexOf("-") >= 0 ){
                    // 조건 패스하는 경우
                } else if (x.length === 0) {
                    // 조건 패스하는 경우
                } else {   // 유저 인풋이 11자리가 아니면 오류메세지
                    // label: error-label 클래스 추가
                    buyerPhone.previousElementSibling.className += " error-label";
                    // input: error-input 클래스 추가
                    buyerPhone.className += " error-input";
                    // p: display block + innerText "11자리 숫자 입력."
                    buyerPhone.nextElementSibling.style.display = "block";
                    buyerPhone.nextElementSibling.innerText = "11자리 숫자 입력";
                }
            })
            buyerPhone.addEventListener("focusin", function() {   // focusin: 오류메세지 원복
                // label: 클래스명 원복
                buyerPhone.previousElementSibling.className = "md-reg";
                // input: 클래스명 원복
                buyerPhone.className = "md-reg";
                // p: display none
                buyerPhone.nextElementSibling.style.display = "none";
            })

            // 입금 정보 ------------------------------------------------------------------------------------------------------------------
            // 구매자와 동일 체크박스 ----------------------------------
            sameAsBuyerCheckBox.addEventListener("click", function(e){
                if (e.target.classList.contains("btn-check_off")){   // 체크가 안 되어 있으면
                    // 구매자 이름이 입력되어 있는지 확인
                    if (buyerName.value){
                        e.target.className = "btn-check_on"   // 체크한다
                        depositName.value = buyerName.value   // 구매자 이름 박아넣기
                        depositName.classList += " disabled-input";   // 비활성화
                    } else {
                        showBuyerNameError();
                    }
                } else {   // 체크가 되어있는걸 풀어버리면
                    e.target.className = "btn-check_off"   // 체크 풀고
                    depositName.classList.remove("disabled-input");   // 비활성화 풀기
                }
            })
            // 보내는 사람 ----------------------------------
            depositName.addEventListener("keyup", function() {
                depositName.value = depositName.value.replace(nameSpecialChar, "");
            });
            depositName.addEventListener("focusout", function() {
                let x = depositName.value;
                if (x.length > 0) {
                    if (x.match(nameSpecialChar) || x.match(notFullKorean)) {
                        x = x.replace(nameSpecialChar, "").replace(notFullKorean, "");
                    }
                    depositName.value = x;
                }
            });
            // 추가 요청사항 ------------------------------------------------------------------------------------------------------------------
            requestTxtarea.addEventListener("keyup", function() {
                let x_length = requestTxtarea.value.length;
                requestCount.innerText = `${x_length}/150`;
                if (x_length > 150) {
                    requestErrorMsg.style.display = "block";
                } else {
                    requestErrorMsg.style.display = "none";
                }
            })
        });

        function test() {
            console.log("클릭됨");
        }
    </script>
</body>
</html>